
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../main/">
      
      
        <link rel="next" href="../commands/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Actions - Rumble Chat Actor Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rumchat_actor.actions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Rumble Chat Actor Docs" class="md-header__button md-logo" aria-label="Rumble Chat Actor Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rumble Chat Actor Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Actions
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Rumble Chat Actor Docs" class="md-nav__button md-logo" aria-label="Rumble Chat Actor Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Rumble Chat Actor Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How-To Guides
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Actions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Actions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions" class="md-nav__link">
    <span class="md-ellipsis">
      actions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper" class="md-nav__link">
    <span class="md-ellipsis">
      ChatBlipper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChatBlipper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.current_volume" class="md-nav__link">
    <span class="md-ellipsis">
      current_volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.load_sound" class="md-nav__link">
    <span class="md-ellipsis">
      load_sound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.reduce_rarity" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_rarity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager" class="md-nav__link">
    <span class="md-ellipsis">
      RantTTSManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RantTTSManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.tts_amount_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      tts_amount_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.set_rant_tts_sayer" class="md-nav__link">
    <span class="md-ellipsis">
      set_rant_tts_sayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker" class="md-nav__link">
    <span class="md-ellipsis">
      Thanker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thanker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager" class="md-nav__link">
    <span class="md-ellipsis">
      TimedMessagesManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimedMessagesManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.sender_loop" class="md-nav__link">
    <span class="md-ellipsis">
      sender_loop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer" class="md-nav__link">
    <span class="md-ellipsis">
      UserAnnouncer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UserAnnouncer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ollama_message_moderate" class="md-nav__link">
    <span class="md-ellipsis">
      ollama_message_moderate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../static/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Static
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../action_properties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Action properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanation
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions" class="md-nav__link">
    <span class="md-ellipsis">
      actions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper" class="md-nav__link">
    <span class="md-ellipsis">
      ChatBlipper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChatBlipper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.current_volume" class="md-nav__link">
    <span class="md-ellipsis">
      current_volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.load_sound" class="md-nav__link">
    <span class="md-ellipsis">
      load_sound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ChatBlipper.reduce_rarity" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_rarity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager" class="md-nav__link">
    <span class="md-ellipsis">
      RantTTSManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RantTTSManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.tts_amount_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      tts_amount_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.RantTTSManager.set_rant_tts_sayer" class="md-nav__link">
    <span class="md-ellipsis">
      set_rant_tts_sayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker" class="md-nav__link">
    <span class="md-ellipsis">
      Thanker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thanker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.Thanker.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager" class="md-nav__link">
    <span class="md-ellipsis">
      TimedMessagesManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimedMessagesManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.TimedMessagesManager.sender_loop" class="md-nav__link">
    <span class="md-ellipsis">
      sender_loop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer" class="md-nav__link">
    <span class="md-ellipsis">
      UserAnnouncer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UserAnnouncer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rumchat_actor.actions.UserAnnouncer.action" class="md-nav__link">
    <span class="md-ellipsis">
      action
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rumchat_actor.actions.ollama_message_moderate" class="md-nav__link">
    <span class="md-ellipsis">
      ollama_message_moderate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Actions</h1>

<div class="doc doc-object doc-module">



<a id="rumchat_actor.actions"></a>
    <div class="doc doc-contents first">

        <p>Common message actions</p>
<p>Actions commonly run on chat messages
S.D.G</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="rumchat_actor.actions.ChatBlipper" class="doc doc-heading">
            <code>ChatBlipper</code>


</h2>


    <div class="doc doc-contents ">


        <p>Blip with chat activity, getting fainter as activity gets more common</p>








              <details class="quote">
                <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ChatBlipper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Blip with chat activity, getting fainter as activity gets more common&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rarity_regen_time</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">stay_dead_time</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rarity_reduce</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Blip with chat activity, getting fainter as activity gets more common.</span>
<span class="sd">    Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">    Args:</span>
<span class="sd">        sound_filename (str): The filename of the blip sound to play.</span>
<span class="sd">        rarity_regen_time (int): How long before the blip volume regenerates to maximum, in seconds.</span>
<span class="sd">        stay_dead_time (int): Effectively more regen time, in seconds, but with the volume staying at zero for the duration.</span>
<span class="sd">        rarity_reduce (float): How much a message reduces the volume in factor, ranging from &gt;0 to 1.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sound</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_sound</span><span class="p">(</span><span class="n">sound_filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span> <span class="o">=</span> <span class="n">rarity_regen_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stay_dead_time</span> <span class="o">=</span> <span class="n">stay_dead_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rarity_reduce</span> <span class="o">=</span> <span class="n">rarity_reduce</span>

        <span class="c1"># Time in the past at which we would have been silent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">load_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a sound from a file to use as a blip&quot;&quot;&quot;</span>
        <span class="c1"># Make sure PyGame mixer is initialized</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mixer</span><span class="o">.</span><span class="n">get_init</span><span class="p">():</span>
            <span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sound</span> <span class="o">=</span> <span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the current volume based on how rare messages have been, from 0 to 1&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="nb">min</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">reduce_rarity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce the remembered rarity of a message&quot;&quot;&quot;</span>
        <span class="n">curtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Limit the effective regen to 100%</span>
        <span class="k">if</span> <span class="n">curtime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="n">curtime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span>

        <span class="c1"># Move the time we &quot;were&quot; silent forward, capping at present + stay-dead time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_reduce</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stay_dead_time</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Blip for a chat message, taking rarity into account for the volume</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_volume</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reduce_rarity</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="rumchat_actor.actions.ChatBlipper.current_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">current_volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the current volume based on how rare messages have been, from 0 to 1</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.ChatBlipper.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sound_filename</span><span class="p">,</span> <span class="n">rarity_regen_time</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">stay_dead_time</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rarity_reduce</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Blip with chat activity, getting fainter as activity gets more common.
Instance this object, then pass it to RumbleChatActor().register_message_action()</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sound_filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the blip sound to play.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rarity_regen_time</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long before the blip volume regenerates to maximum, in seconds.</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stay_dead_time</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Effectively more regen time, in seconds, but with the volume staying at zero for the duration.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rarity_reduce</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How much a message reduces the volume in factor, ranging from &gt;0 to 1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rarity_regen_time</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">stay_dead_time</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rarity_reduce</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Blip with chat activity, getting fainter as activity gets more common.</span>
<span class="sd">Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">Args:</span>
<span class="sd">    sound_filename (str): The filename of the blip sound to play.</span>
<span class="sd">    rarity_regen_time (int): How long before the blip volume regenerates to maximum, in seconds.</span>
<span class="sd">    stay_dead_time (int): Effectively more regen time, in seconds, but with the volume staying at zero for the duration.</span>
<span class="sd">    rarity_reduce (float): How much a message reduces the volume in factor, ranging from &gt;0 to 1.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sound</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_sound</span><span class="p">(</span><span class="n">sound_filename</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span> <span class="o">=</span> <span class="n">rarity_regen_time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stay_dead_time</span> <span class="o">=</span> <span class="n">stay_dead_time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rarity_reduce</span> <span class="o">=</span> <span class="n">rarity_reduce</span>

    <span class="c1"># Time in the past at which we would have been silent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.ChatBlipper.action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Blip for a chat message, taking rarity into account for the volume</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Blip for a chat message, taking rarity into account for the volume</span>

<span class="sd">Args:</span>
<span class="sd">    message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">    act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">    actor (RumbleChatActor): The chat actor.</span>

<span class="sd">Returns:</span>
<span class="sd">    act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_volume</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reduce_rarity</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.ChatBlipper.load_sound" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_sound</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a sound from a file to use as a blip</p>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a sound from a file to use as a blip&quot;&quot;&quot;</span>
    <span class="c1"># Make sure PyGame mixer is initialized</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mixer</span><span class="o">.</span><span class="n">get_init</span><span class="p">():</span>
        <span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sound</span> <span class="o">=</span> <span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.ChatBlipper.reduce_rarity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduce_rarity</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reduce the remembered rarity of a message</p>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reduce_rarity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduce the remembered rarity of a message&quot;&quot;&quot;</span>
    <span class="n">curtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Limit the effective regen to 100%</span>
    <span class="k">if</span> <span class="n">curtime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="n">curtime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span>

    <span class="c1"># Move the time we &quot;were&quot; silent forward, capping at present + stay-dead time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">silent_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_regen_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rarity_reduce</span><span class="p">,</span> <span class="n">curtime</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stay_dead_time</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rumchat_actor.actions.RantTTSManager" class="doc doc-heading">
            <code>RantTTSManager</code>


</h2>


    <div class="doc doc-contents ">


        <p>System to TTS rant messages, with threshhold settings</p>








              <details class="quote">
                <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RantTTSManager</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;System to TTS rant messages, with threshhold settings&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;System to TTS rant messages, with threshhold settings.</span>
<span class="sd">    Instance this object, then pass it to RumbleChatActor().register_message_action()&quot;&quot;&quot;</span>

        <span class="c1"># The amount a rant must be to be TTS-ed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># The TTS callable to use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__say</span> <span class="o">=</span> <span class="n">talkey</span><span class="o">.</span><span class="n">Talkey</span><span class="p">()</span><span class="o">.</span><span class="n">say</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tts_amount_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The amount a rant must be to be TTS-ed, 0 means all rants are TTS-ed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span>

    <span class="nd">@tts_amount_threshold</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">tts_amount_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The amount a rant must be to be TTS-ed, 0 means all rants are TTS-ed</span>

<span class="sd">    Args:</span>
<span class="sd">        new (int): The new threshold in cents.&quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">new</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Value must be a number greater than zero&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span> <span class="o">=</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">set_rant_tts_sayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the callable to be used on rant TTS</span>

<span class="sd">    Args:</span>
<span class="sd">        new (callable): The function or method to call, passing the message text.&quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="s2">&quot;Must be a callable&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__say</span> <span class="o">=</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;TTS rants above the manager instance&#39;s threshhold</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

        <span class="c1"># Do not overlap sounds</span>
        <span class="k">if</span> <span class="n">act_props</span><span class="p">[</span><span class="s2">&quot;sound&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">is_rant</span> <span class="ow">and</span> <span class="n">message</span><span class="o">.</span><span class="n">rant_price_cents</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__say</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;sound&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="rumchat_actor.actions.RantTTSManager.tts_amount_threshold" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tts_amount_threshold</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The amount a rant must be to be TTS-ed, 0 means all rants are TTS-ed</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.RantTTSManager.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>System to TTS rant messages, with threshhold settings.
Instance this object, then pass it to RumbleChatActor().register_message_action()</p>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;System to TTS rant messages, with threshhold settings.</span>
<span class="sd">Instance this object, then pass it to RumbleChatActor().register_message_action()&quot;&quot;&quot;</span>

    <span class="c1"># The amount a rant must be to be TTS-ed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># The TTS callable to use</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__say</span> <span class="o">=</span> <span class="n">talkey</span><span class="o">.</span><span class="n">Talkey</span><span class="p">()</span><span class="o">.</span><span class="n">say</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.RantTTSManager.action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>TTS rants above the manager instance's threshhold</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TTS rants above the manager instance&#39;s threshhold</span>

<span class="sd">Args:</span>
<span class="sd">    message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">    act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">    actor (RumbleChatActor): The chat actor.</span>

<span class="sd">Returns:</span>
<span class="sd">    act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="c1"># Do not overlap sounds</span>
    <span class="k">if</span> <span class="n">act_props</span><span class="p">[</span><span class="s2">&quot;sound&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">is_rant</span> <span class="ow">and</span> <span class="n">message</span><span class="o">.</span><span class="n">rant_price_cents</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tts_amount_threshold</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__say</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;sound&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.RantTTSManager.set_rant_tts_sayer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_rant_tts_sayer</span><span class="p">(</span><span class="n">new</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the callable to be used on rant TTS</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function or method to call, passing the message text.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_rant_tts_sayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the callable to be used on rant TTS</span>

<span class="sd">Args:</span>
<span class="sd">    new (callable): The function or method to call, passing the message text.&quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="s2">&quot;Must be a callable&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__say</span> <span class="o">=</span> <span class="n">new</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rumchat_actor.actions.Thanker" class="doc doc-heading">
            <code>Thanker</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="threading.Thread">Thread</span></code></p>


        <p>Thank followers and subscribers in the chat</p>








              <details class="quote">
                <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Thanker</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Thank followers and subscribers in the chat&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thank followers and subscribers in the chat.</span>
<span class="sd">    Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">    Args:</span>
<span class="sd">        actor (RumbleChatActor): The Rumble Chat Actor instance.</span>
<span class="sd">        follower_message (str): Message to format with Cocorum Follower object.</span>
<span class="sd">            Defaults to static.Thank.DefaultMessages.follower</span>
<span class="sd">        subscriber_message (str): Message to format with the Cocorum Subscriber object.</span>
<span class="sd">            Defaults to static.Thank.DefaultMessages.subscriber</span>
<span class="sd">        gifted_subs_message (str): Message to format with the Cocorum GiftPurchaseNotification object.</span>
<span class="sd">            Defaults to static.Thank.DefaultMessages.gifted_subs&quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">rum_api</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="p">,</span> <span class="s2">&quot;Thanker cannot function if actor does not have Rumble API&quot;</span>

        <span class="c1"># Set up default messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;follower_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">follower</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscriber_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subscriber_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">subscriber</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gifted_subs_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gifted_subs_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">gifted_subs</span><span class="p">)</span>

        <span class="c1"># Start the thread immediately</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for subscription gifts, and thank for them</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

        <span class="n">gift</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">gift_purchase_notification</span>

        <span class="c1"># This is not a gift purchase notification</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">gift</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gifted_subs_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gift</span><span class="o">=</span><span class="n">gift</span><span class="p">))</span>

        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Continuously check for new followers and subscribers&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">keep_running</span><span class="p">:</span>
            <span class="c1"># Thank all the new followers</span>
            <span class="k">for</span> <span class="n">follower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">new_followers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">follower</span><span class="o">=</span><span class="n">follower</span><span class="p">))</span>

            <span class="c1"># Thank all the new subscribers</span>
            <span class="k">for</span> <span class="n">subscriber</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">new_subscribers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subscriber</span><span class="o">=</span><span class="n">subscriber</span><span class="p">))</span>

            <span class="c1"># Wait a bit, either the Rumble API refresh rate or the message sending cooldown</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">refresh_rate</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">send_cooldown</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.Thanker.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Thank followers and subscribers in the chat.
Instance this object, then pass it to RumbleChatActor().register_message_action()</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Rumble Chat Actor instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>follower_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to format with Cocorum Follower object.
Defaults to static.Thank.DefaultMessages.follower</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subscriber_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to format with the Cocorum Subscriber object.
Defaults to static.Thank.DefaultMessages.subscriber</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gifted_subs_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to format with the Cocorum GiftPurchaseNotification object.
Defaults to static.Thank.DefaultMessages.gifted_subs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Thank followers and subscribers in the chat.</span>
<span class="sd">Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">Args:</span>
<span class="sd">    actor (RumbleChatActor): The Rumble Chat Actor instance.</span>
<span class="sd">    follower_message (str): Message to format with Cocorum Follower object.</span>
<span class="sd">        Defaults to static.Thank.DefaultMessages.follower</span>
<span class="sd">    subscriber_message (str): Message to format with the Cocorum Subscriber object.</span>
<span class="sd">        Defaults to static.Thank.DefaultMessages.subscriber</span>
<span class="sd">    gifted_subs_message (str): Message to format with the Cocorum GiftPurchaseNotification object.</span>
<span class="sd">        Defaults to static.Thank.DefaultMessages.gifted_subs&quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">rum_api</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="p">,</span> <span class="s2">&quot;Thanker cannot function if actor does not have Rumble API&quot;</span>

    <span class="c1"># Set up default messages</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;follower_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">follower</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">subscriber_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subscriber_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">subscriber</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gifted_subs_message</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gifted_subs_message&quot;</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Thank</span><span class="o">.</span><span class="n">DefaultMessages</span><span class="o">.</span><span class="n">gifted_subs</span><span class="p">)</span>

    <span class="c1"># Start the thread immediately</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.Thanker.action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check for subscription gifts, and thank for them</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for subscription gifts, and thank for them</span>

<span class="sd">Args:</span>
<span class="sd">    message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">    act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">    actor (RumbleChatActor): The chat actor.</span>

<span class="sd">Returns:</span>
<span class="sd">    act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="n">gift</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">gift_purchase_notification</span>

    <span class="c1"># This is not a gift purchase notification</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">gift</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gifted_subs_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gift</span><span class="o">=</span><span class="n">gift</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.Thanker.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Continuously check for new followers and subscribers</p>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Continuously check for new followers and subscribers&quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">keep_running</span><span class="p">:</span>
        <span class="c1"># Thank all the new followers</span>
        <span class="k">for</span> <span class="n">follower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">new_followers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">follower</span><span class="o">=</span><span class="n">follower</span><span class="p">))</span>

        <span class="c1"># Thank all the new subscribers</span>
        <span class="k">for</span> <span class="n">subscriber</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">new_subscribers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">follower_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subscriber</span><span class="o">=</span><span class="n">subscriber</span><span class="p">))</span>

        <span class="c1"># Wait a bit, either the Rumble API refresh rate or the message sending cooldown</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rum_api</span><span class="o">.</span><span class="n">refresh_rate</span><span class="p">,</span> <span class="n">static</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">send_cooldown</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rumchat_actor.actions.TimedMessagesManager" class="doc doc-heading">
            <code>TimedMessagesManager</code>


</h2>


    <div class="doc doc-contents ">


        <p>System to send messages on a timed basis</p>








              <details class="quote">
                <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimedMessagesManager</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;System to send messages on a timed basis&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">in_between</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;System to send messages on a timed basis. Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">    Args:</span>
<span class="sd">        actor (RumbleChatActor): The actor, to send the timed messages,</span>
<span class="sd">        messages (list): List of str messages to send</span>
<span class="sd">        delay (int): Time between messages in seconds</span>
<span class="sd">        in_between (int): Number of messages that must be sent before we send another timed one&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;List of messages to send cannot be empty&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="n">messages</span>
        <span class="k">assert</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="n">static</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">send_cooldown</span><span class="p">,</span> <span class="s2">&quot;Cannot send timed messages that frequently&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_between</span> <span class="o">=</span> <span class="n">in_between</span>

        <span class="c1"># Next message to send</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Time of last send</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Counter for messages sent since our last announcement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Start the sender loop thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender_loop</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Count the messages sent</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">sender_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Continuously wait till it is time to send another message&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="c1"># time to send a message?</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_between</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">:</span>
                <span class="c1"># Send a message</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span><span class="p">])</span>

                <span class="c1"># Up the index of the next message, with wrapping</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># Reset wait counters</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.TimedMessagesManager.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">in_between</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>System to send messages on a timed basis. Instance this object, then pass it to RumbleChatActor().register_message_action()</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The actor, to send the timed messages,</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of str messages to send</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delay</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time between messages in seconds</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_between</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of messages that must be sent before we send another timed one</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">in_between</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;System to send messages on a timed basis. Instance this object, then pass it to RumbleChatActor().register_message_action()</span>

<span class="sd">Args:</span>
<span class="sd">    actor (RumbleChatActor): The actor, to send the timed messages,</span>
<span class="sd">    messages (list): List of str messages to send</span>
<span class="sd">    delay (int): Time between messages in seconds</span>
<span class="sd">    in_between (int): Number of messages that must be sent before we send another timed one&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;List of messages to send cannot be empty&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="n">messages</span>
    <span class="k">assert</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="n">static</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">send_cooldown</span><span class="p">,</span> <span class="s2">&quot;Cannot send timed messages that frequently&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_between</span> <span class="o">=</span> <span class="n">in_between</span>

    <span class="c1"># Next message to send</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Time of last send</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Counter for messages sent since our last announcement</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Start the sender loop thread</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sender_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender_loop</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sender_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.TimedMessagesManager.action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Count the messages sent</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count the messages sent</span>

<span class="sd">Args:</span>
<span class="sd">    message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">    act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">    actor (RumbleChatActor): The chat actor.</span>

<span class="sd">Returns:</span>
<span class="sd">    act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.TimedMessagesManager.sender_loop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sender_loop</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Continuously wait till it is time to send another message</p>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sender_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Continuously wait till it is time to send another message&quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
        <span class="c1"># time to send a message?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_between</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">:</span>
            <span class="c1"># Send a message</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span><span class="p">])</span>

            <span class="c1"># Up the index of the next message, with wrapping</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up_next_index</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Reset wait counters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_between_counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_send_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rumchat_actor.actions.UserAnnouncer" class="doc doc-heading">
            <code>UserAnnouncer</code>


</h2>


    <div class="doc doc-contents ">


        <p>Announce new users as they arrive in the chat</p>








              <details class="quote">
                <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UserAnnouncer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Announce new users as they arrive in the chat&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">announcer</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">known_users</span><span class="o">=</span><span class="p">[],</span> <span class="n">special_announcers</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Announce new users as they arrive in the chat</span>

<span class="sd">        Args:</span>
<span class="sd">            announcer (callable): Function or method to call. Will be passed</span>
<span class="sd">                the message action special of message, act_props, and actor.</span>
<span class="sd">                Should return act_props dict likewise.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            known_users (list): List of users not to announce. Useful if you</span>
<span class="sd">                only want this announcer to go off for brand new chatters. You</span>
<span class="sd">                can save this list after actor exit from this object&#39;s</span>
<span class="sd">                `.known_users` attribute.</span>
<span class="sd">            special_announcers (dict[str, callable]): Dict of username to</span>
<span class="sd">                announcer callable pairs. Should take same args as regular</span>
<span class="sd">                announcers, but they will only be called on the username that</span>
<span class="sd">                matches them.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">announcer</span> <span class="o">=</span> <span class="n">announcer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span> <span class="o">=</span> <span class="n">known_users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_announcers</span> <span class="o">=</span> <span class="n">special_announcers</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Announce the user if they are new</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

        <span class="c1"># We already announced this user</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Remember this user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

        <span class="c1"># We might have a special announcer for this user</span>
        <span class="n">ann</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_announcers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">announcer</span><span class="p">)</span>

        <span class="c1"># Our main announcer may be None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ann</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;announced&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">props</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.UserAnnouncer.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">announcer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">known_users</span><span class="o">=</span><span class="p">[],</span> <span class="n">special_announcers</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Announce new users as they arrive in the chat</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>announcer</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function or method to call. Will be passed
the message action special of message, act_props, and actor.
Should return act_props dict likewise.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>known_users</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of users not to announce. Useful if you
only want this announcer to go off for brand new chatters. You
can save this list after actor exit from this object's
<code>.known_users</code> attribute.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>special_announcers</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="callable">callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of username to
announcer callable pairs. Should take same args as regular
announcers, but they will only be called on the username that
matches them.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">announcer</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">known_users</span><span class="o">=</span><span class="p">[],</span> <span class="n">special_announcers</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Announce new users as they arrive in the chat</span>

<span class="sd">    Args:</span>
<span class="sd">        announcer (callable): Function or method to call. Will be passed</span>
<span class="sd">            the message action special of message, act_props, and actor.</span>
<span class="sd">            Should return act_props dict likewise.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        known_users (list): List of users not to announce. Useful if you</span>
<span class="sd">            only want this announcer to go off for brand new chatters. You</span>
<span class="sd">            can save this list after actor exit from this object&#39;s</span>
<span class="sd">            `.known_users` attribute.</span>
<span class="sd">        special_announcers (dict[str, callable]): Dict of username to</span>
<span class="sd">            announcer callable pairs. Should take same args as regular</span>
<span class="sd">            announcers, but they will only be called on the username that</span>
<span class="sd">            matches them.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">announcer</span> <span class="o">=</span> <span class="n">announcer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span> <span class="o">=</span> <span class="n">known_users</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">special_announcers</span> <span class="o">=</span> <span class="n">special_announcers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rumchat_actor.actions.UserAnnouncer.action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">action</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Announce the user if they are new</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Announce the user if they are new</span>

<span class="sd">Args:</span>
<span class="sd">    message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">    act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">    actor (RumbleChatActor): The chat actor.</span>

<span class="sd">Returns:</span>
<span class="sd">    act_props (dict): Dictionary of additional recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="c1"># We already announced this user</span>
    <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Remember this user</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">known_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

    <span class="c1"># We might have a special announcer for this user</span>
    <span class="n">ann</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_announcers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">announcer</span><span class="p">)</span>

    <span class="c1"># Our main announcer may be None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ann</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span>
    <span class="n">props</span><span class="p">[</span><span class="s2">&quot;announced&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">props</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="rumchat_actor.actions.ollama_message_moderate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ollama_message_moderate</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Moderate a message with Ollama, deleting if needed</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="cocorum.chatapi.Message">Message</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat message to run this action on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>act_props</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action properties, aka metadata about what other things did with this message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RumbleChatActor (rumchat_actor.RumbleChatActor)" href="../main/#rumchat_actor.RumbleChatActor">RumbleChatActor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chat actor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>act_props</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of recorded properties from running this action.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>rumchat_actor/actions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ollama_message_moderate</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">act_props</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Moderate a message with Ollama, deleting if needed</span>

<span class="sd">    Args:</span>
<span class="sd">        message (cocorum.chatapi.Message): The chat message to run this action on.</span>
<span class="sd">        act_props (dict): Action properties, aka metadata about what other things did with this message</span>
<span class="sd">        actor (RumbleChatActor): The chat actor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        act_props (dict): Dictionary of recorded properties from running this action.&quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">OLLAMA_IMPORTED</span><span class="p">,</span> <span class="s2">&quot;The Ollama library and a working Ollama installation are required for ollama_message_moderate&quot;</span>

    <span class="c1"># Message was blank</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Message was blank.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># User has an immunity badge</span>
    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">badge</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">badges</span> <span class="k">for</span> <span class="n">badge</span> <span class="ow">in</span> <span class="n">static</span><span class="o">.</span><span class="n">Moderation</span><span class="o">.</span><span class="n">staff_badges</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s2"> is staff, skipping LLM check.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># Get the LLM verdict</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">ollama</span><span class="o">.</span><span class="n">chat</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">static</span><span class="o">.</span><span class="n">AutoModerator</span><span class="o">.</span><span class="n">llm_model</span><span class="p">,</span> <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">static</span><span class="o">.</span><span class="n">AutoModerator</span><span class="o">.</span><span class="n">llm_sys_prompt</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">},</span>
        <span class="p">])</span>

    <span class="c1"># Parse the verdict</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">verdict</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">])</span>

    <span class="c1"># Verdict was not valid</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad verdict for </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># Response was not in expected format</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not get verdict for </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> : Response: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># Returned 1 for SFW</span>
    <span class="k">if</span> <span class="n">verdict</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LLM verdicted as clean: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># Returned 0 for NSFW</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LLM verdicted as dirty: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;deleted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>